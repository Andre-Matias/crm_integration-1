<?xml version="1.0" encoding="UTF-8"?>
<job>
  <name>AWS Daily Load - Vertical Services - ODL - Fixly - Model Tables</name>
  <description/>
  <extended_description/>
  <job_version/>
  <directory>&#x2f;</directory>
  <created_user>-</created_user>
  <created_date>2017&#x2f;09&#x2f;26 11&#x3a;45&#x3a;22.592</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;09&#x2f;26 11&#x3a;45&#x3a;22.592</modified_date>
    <parameters>
    </parameters>
  <connection>
    <name>Chandra Redshift</name>
    <server>gv-chandra.ckwrimb1igb1.us-west-2.redshift.amazonaws.com</server>
    <type>REDSHIFT</type>
    <access>Native</access>
    <database>globalverticals</database>
    <port>5439</port>
    <username>pyrate</username>
    <password>Encrypted 2be98afc86af78b96aa0dab24d29ba9df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_REDSHIFT.tcpKeepAlive</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5439</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
      <job-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_JOB</id>
          <enabled>Y</enabled>
          <name>ID_JOB</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>JOBNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>START_JOB_ENTRY</id>
          <enabled>N</enabled>
          <name>START_JOB_ENTRY</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </job-log-table>
      <jobentry-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>JOBENTRYNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>RESULT</id>
          <enabled>Y</enabled>
          <name>RESULT</name>
        </field>
        <field>
          <id>NR_RESULT_ROWS</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_ROWS</name>
        </field>
        <field>
          <id>NR_RESULT_FILES</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_FILES</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>COPY_NR</id>
          <enabled>N</enabled>
          <name>COPY_NR</name>
        </field>
      </jobentry-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>240</xloc>
      <yloc>32</yloc>
    </entry>
    <entry>
      <name>&#xc9;xito</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>896</xloc>
      <yloc>576</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_messages</name>
      <description/>
      <type>SQL</type>
      <sql>-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- SERVICE REQUESTS MESSAGES&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_service_request_messages&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_service_request_messages&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_service_request_messages&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_service_request_messages&#x3b;&#xd;&#xa;&#xd;&#xa;create temp table aux_vert_services_fixly_odl_service_request_messages &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id integer,&#xd;&#xa;conversation_id integer ,&#xd;&#xa;from_id  integer ,&#xd;&#xa;to_id integer ,&#xd;&#xa;message VARCHAR&#x28;1000&#x29; ,&#xd;&#xa;user_agent VARCHAR&#x28;256&#x29;,&#xd;&#xa;created_at TIMESTAMP,&#xd;&#xa;updated_at TIMESTAMP,&#xd;&#xa;deleted_at TIMESTAMP,&#xd;&#xa;sr_category_l1_id integer,&#xd;&#xa;sr_category_l2_id integer,&#xd;&#xa;sr_category_l3_id integer,&#xd;&#xa;sr_category_l1_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;sr_category_l2_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;sr_category_l3_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_country_id integer,&#xd;&#xa;usr_region_id integer,&#xd;&#xa;usr_district_id integer,&#xd;&#xa;usr_city_id integer,&#xd;&#xa;usr_country_name VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_region_name  VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_district_name  VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_city_name  VARCHAR&#x28;256&#x29;,&#xd;&#xa;srd_details VARCHAR&#x28;3000&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- insert like this just for the first time&#xd;&#xa;insert into  aux_vert_services_fixly_odl_service_request_messages &#x28;&#xd;&#xa;select&#xd;&#xa;current_date as inserted_date,&#xd;&#xa;&#x27;&#x27; as status,&#xd;&#xa;&#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;srm.id,&#xd;&#xa;srm.conversation_id,&#xd;&#xa;srm.from_id,&#xd;&#xa;srm.to_id,&#xd;&#xa;srm.message,&#xd;&#xa;srm.user_agent,&#xd;&#xa;srm.created_at,&#xd;&#xa;srm.updated_at,&#xd;&#xa;srm.deleted_at,&#xd;&#xa;l1.id as sr_category_l1_id,&#xd;&#xa;l2.id as sr_category_l2_id,&#xd;&#xa;sr.category_id as sr_category_l3_id,&#xd;&#xa;l1.name as sr_category_l1_desc,&#xd;&#xa;l2.name as sr_category_l2_desc,&#xd;&#xa;l3.name as sr_category_l3_desc,&#xd;&#xa;CE.id as usr_country_id,&#xd;&#xa;R.id as usr_region_id,&#xd;&#xa;D.id as usr_district_id,&#xd;&#xa;C.id AS usr_city_id,&#xd;&#xa;CE.name as usr_country_name,&#xd;&#xa;R.name as usr_region_name,&#xd;&#xa;D.name as usr_district_name,&#xd;&#xa;C.name AS usr_city_name,&#xd;&#xa;null  AS srd_details&#xd;&#xa;from       rdl_vertical_services.fixpl_service_request_messages srm&#xd;&#xa;LEFT JOIN  rdl_vertical_services.fixpl_service_request_conversations  as src on &#x28;srm.conversation_id&#x3d;src.id&#x29;&#xd;&#xa;LEFT JOIN  rdl_vertical_services.fixpl_users as u                on &#x28;u.id&#x3d;srm.from_id and srm.conversation_id&#x3d;src.id&#x29;&#xd;&#xa;left join  rdl_vertical_services.fixpl_service_requests as sr on &#x28;sr.id&#x3d;src.service_request_id&#x29;&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_categories         AS l3 ON l3.id &#x3d; sr.category_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_top_categories     AS l2 ON l2.id &#x3d; l3.parent_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_main_categories    AS l1 ON l1.id &#x3d; l2.parent_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_cities             AS c  ON c.id &#x3d;u.city_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_districts          AS D  ON D.id &#x3d; c.district_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_regions            AS R  ON R.id &#x3d; c.region_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_country_entities   AS CE ON CE.id &#x3d; c.entity_id&#xd;&#xa;group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27&#xd;&#xa;order by 1,2,3,4,5&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_novos_service_request_messages&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_request_messages as m&#xd;&#xa;  FULL OUTER JOIN  aux_vert_services_fixly_odl_service_request_messages as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where&#xd;&#xa;      m.id is null order by a.created_at asc&#x3b;&#xd;&#xa;-- select &#x2a; from tmp_novos_service_request_messages&#x3b;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_service_request_messages &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;CREATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  message,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name,&#xd;&#xa;  srd_details&#xd;&#xa;from tmp_novos_service_request_messages&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_service_request_messages&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_request_messages as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_service_request_messages as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_service_request_messages&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_service_request_messages  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;UPDATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  message,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name,&#xd;&#xa;  srd_details&#xd;&#xa;from tmp_updated_service_request_messages&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_service_request_messages&#xd;&#xa;from aux_vert_services_fixly_odl_service_request_messages as a&#xd;&#xa;  left join odl_global_verticals.vert_services_fixly_odl_service_request_messages as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_service_request_messages &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;DELETED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  message,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name,&#xd;&#xa;  srd_details&#xd;&#xa;from tmp_deleted_service_request_messages&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>352</xloc>
      <yloc>112</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_conversations</name>
      <description/>
      <type>SQL</type>
      <sql>-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- SERVICE REQUESTS CONVERSATIONS&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_service_request_conversations&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_service_request_conversations&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_service_request_conversations&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_service_request_conversations&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;create temp table aux_vert_services_fixly_odl_service_request_conversations &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id                 integer,&#xd;&#xa;service_request_id integer,&#xd;&#xa;professional_id    integer,&#xd;&#xa;offer              BOOL,&#xd;&#xa;accepted_at        TIMESTAMP,&#xd;&#xa;created_at         TIMESTAMP,&#xd;&#xa;updated_at         TIMESTAMP,&#xd;&#xa;deleted_at         TIMESTAMP,&#xd;&#xa;sr_user_agent      VARCHAR&#x28;256&#x29;,&#xd;&#xa;sr_category_l1_id integer,&#xd;&#xa;sr_category_l2_id integer,&#xd;&#xa;sr_category_l3_id integer,&#xd;&#xa;sr_category_l1_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;sr_category_l2_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;sr_category_l3_desc VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_country_id integer,&#xd;&#xa;usr_region_id integer,&#xd;&#xa;usr_district_id integer,&#xd;&#xa;usr_city_id integer,&#xd;&#xa;usr_country_name VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_region_name  VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_district_name  VARCHAR&#x28;256&#x29;,&#xd;&#xa;usr_city_name  VARCHAR&#x28;256&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;insert into aux_vert_services_fixly_odl_service_request_conversations &#x28;&#xd;&#xa;select&#xd;&#xa;current_date as inserted_date,&#xd;&#xa;&#x27;&#x27; as status,&#xd;&#xa;&#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;src.id                 ,&#xd;&#xa;src.service_request_id ,&#xd;&#xa;src.professional_id    ,&#xd;&#xa;src.offer              ,&#xd;&#xa;src.accepted_at        ,&#xd;&#xa;src.created_at         ,&#xd;&#xa;src.updated_at         ,&#xd;&#xa;src.deleted_at         ,&#xd;&#xa;sr.user_agent   as sr_user_agent,&#xd;&#xa;l1.id as sr_category_l1_id,&#xd;&#xa;l2.id as sr_category_l2_id,&#xd;&#xa;sr.category_id as sr_category_l3_id,&#xd;&#xa;l1.name as sr_category_l1_desc,&#xd;&#xa;l2.name as sr_category_l2_desc,&#xd;&#xa;l3.name as sr_category_l3_desc,&#xd;&#xa;C.id as usr_country_id,&#xd;&#xa;R.id as usr_region_id,&#xd;&#xa;D.id as usr_district_id,&#xd;&#xa;u.city_id AS usr_city_id,&#xd;&#xa;CE.name as usr_country_name,&#xd;&#xa;R.name as usr_region_name,&#xd;&#xa;D.name as usr_district_name,&#xd;&#xa;C.name AS usr_city_name&#xd;&#xa;from&#xd;&#xa;           rdl_vertical_services.fixpl_service_request_conversations  as src&#xd;&#xa;LEFT JOIN  rdl_vertical_services.fixpl_users as u                            on &#x28;u.id&#x3d;src.professional_id&#x29;&#xd;&#xa;left join  rdl_vertical_services.fixpl_service_requests as sr                on &#x28;sr.id&#x3d;src.service_request_id&#x29;&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_categories         AS l3 ON l3.id &#x3d; sr.category_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_top_categories     AS l2 ON l2.id &#x3d; l3.parent_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_main_categories    AS l1 ON l1.id &#x3d; l2.parent_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_cities             AS c  ON c.id &#x3d;u.city_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_districts          AS D  ON D.id &#x3d; c.district_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_regions            AS R  ON R.id &#x3d; c.region_id&#xd;&#xa;left  JOIN rdl_vertical_services.fixpl_country_entities   AS CE ON CE.id &#x3d; c.entity_id&#xd;&#xa;group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26&#xd;&#xa;order by 1,2,3,4,5&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;-- select &#x2a; from aux_vert_services_fixly_odl_service_request_conversations&#x3b;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa; into temp tmp_novos_service_request_conversations&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_request_conversations as m&#xd;&#xa;  FULL OUTER JOIN  aux_vert_services_fixly_odl_service_request_conversations  as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where&#xd;&#xa;      m.id is null order by a.created_at asc&#x3b;&#xd;&#xa;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_service_request_conversations  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;CREATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  service_request_id,&#xd;&#xa;  professional_id,&#xd;&#xa;  offer,&#xd;&#xa;  accepted_at,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_user_agent,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name&#xd;&#xa;from tmp_novos_service_request_conversations&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_service_request_conversations&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_request_conversations as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_service_request_conversations as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_service_request_conversations&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_service_request_conversations  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;UPDATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  service_request_id,&#xd;&#xa;  professional_id,&#xd;&#xa;  offer,&#xd;&#xa;  accepted_at,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_user_agent,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name&#xd;&#xa;from tmp_updated_service_request_conversations&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_service_request_conversations&#xd;&#xa;from          aux_vert_services_fixly_odl_service_request_conversations as a&#xd;&#xa;  left join   odl_global_verticals.vert_services_fixly_odl_service_request_conversations as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_service_request_conversations  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;DELETED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  service_request_id,&#xd;&#xa;  professional_id,&#xd;&#xa;  offer,&#xd;&#xa;  accepted_at,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  sr_user_agent,&#xd;&#xa;  sr_category_l1_id,&#xd;&#xa;  sr_category_l2_id,&#xd;&#xa;  sr_category_l3_id,&#xd;&#xa;  sr_category_l1_desc,&#xd;&#xa;  sr_category_l2_desc,&#xd;&#xa;  sr_category_l3_desc,&#xd;&#xa;  usr_country_id,&#xd;&#xa;  usr_region_id,&#xd;&#xa;  usr_district_id,&#xd;&#xa;  usr_city_id,&#xd;&#xa;  usr_country_name,&#xd;&#xa;  usr_region_name,&#xd;&#xa;  usr_district_name,&#xd;&#xa;  usr_city_name&#xd;&#xa;from tmp_deleted_service_request_conversations&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>432</xloc>
      <yloc>176</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_offers</name>
      <description/>
      <type>SQL</type>
      <sql>-- OFFERS&#xd;&#xa;&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_offers&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_offers&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_offers&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_offers&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;create table aux_vert_services_fixly_odl_offers &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id              integer,&#xd;&#xa;conversation_id integer,&#xd;&#xa;price           DOUBLE PREcISION,&#xd;&#xa;price_type      integer,&#xd;&#xa;offer_accepted  bool,&#xd;&#xa;created_at      timestamp,&#xd;&#xa;updated_at      timestamp,&#xd;&#xa;deleted_at       timestamp&#xd;&#xa;&#x29;&#xd;&#xa;DISTSTYLE KEY&#xd;&#xa;DISTKEY &#x28;id&#x29;&#xd;&#xa;SORTKEY &#x28;id&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;insert into aux_vert_services_fixly_odl_offers &#x28;&#xd;&#xa;  SELECT&#xd;&#xa;    current_date   AS inserted_date,&#xd;&#xa;    &#x27;&#x27;             AS status,&#xd;&#xa;    &#x27;fixly-poland&#x27; AS db_name,&#xd;&#xa;    id                ,&#xd;&#xa;    conversation_id   ,&#xd;&#xa;    price            ,&#xd;&#xa;    price_type        ,&#xd;&#xa;    offer_accepted    ,&#xd;&#xa;    created_at        ,&#xd;&#xa;    updated_at        ,&#xd;&#xa;    deleted_at&#xd;&#xa;  FROM rdl_vertical_services.fixpl_offers&#xd;&#xa;  group by 1,2,3,4,5,6,7,8,9,10,11 order by 1,2,3,4,5,6,7,8,9,10,11&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from aux_vert_services_fixly_odl_offers&#x3b;&#xd;&#xa;-- select &#x2a; from odl_global_verticals.vert_services_fixly_odl_offers&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_novos_offers&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_offers as m&#xd;&#xa;  FULL OUTER JOIN  aux_vert_services_fixly_odl_offers as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where&#xd;&#xa;      m.id is null order by a.created_at asc&#x3b;&#xd;&#xa;-- select &#x2a; from tmp_novos&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_offers  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;CREATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  price,&#xd;&#xa;  price_type,&#xd;&#xa;  offer_accepted,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at&#xd;&#xa;from tmp_novos_offers&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_offers&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_offers as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_offers as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_offers&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_offers  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;UPDATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  price,&#xd;&#xa;  price_type,&#xd;&#xa;  offer_accepted,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at&#xd;&#xa;from tmp_updated_offers&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_offers&#xd;&#xa;from aux_vert_services_fixly_odl_offers as a&#xd;&#xa;  left join odl_global_verticals.vert_services_fixly_odl_offers as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_offers  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;DELETED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  conversation_id,&#xd;&#xa;  price,&#xd;&#xa;  price_type,&#xd;&#xa;  offer_accepted,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at&#xd;&#xa;from tmp_deleted_offers&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>512</xloc>
      <yloc>240</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_feedback</name>
      <description/>
      <type>SQL</type>
      <sql>-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- feedback&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_feedback&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_feedback&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_feedback&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_feedback&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;create table aux_vert_services_fixly_odl_feedback &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id  integer,&#xd;&#xa;value DOUBLE PREcISION ,&#xd;&#xa;comment VARCHAR&#x28;5000&#x29;,&#xd;&#xa;service_request_id integer,&#xd;&#xa;service_id integer,&#xd;&#xa;from_id integer,&#xd;&#xa;to_id integer,&#xd;&#xa;title VARCHAR&#x28;256&#x29; not null,&#xd;&#xa;active bool,&#xd;&#xa;created_at timestamp,&#xd;&#xa;updated_at timestamp,&#xd;&#xa;deleted_at timestamp,&#xd;&#xa;rating_user_agent VARCHAR&#x28;30&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into aux_vert_services_fixly_odl_feedback &#x28;&#xd;&#xa;select&#xd;&#xa;    current_date   AS inserted_date,&#xd;&#xa;    &#x27;&#x27;             AS status,&#xd;&#xa;    &#x27;fixly-poland&#x27; AS db_name,&#xd;&#xa;id,&#xd;&#xa;value,&#xd;&#xa;comment,&#xd;&#xa;service_request_id,&#xd;&#xa;service_id ,&#xd;&#xa;from_id ,&#xd;&#xa;to_id ,&#xd;&#xa;title ,&#xd;&#xa;active ,&#xd;&#xa;created_at ,&#xd;&#xa;updated_at,&#xd;&#xa;deleted_at ,&#xd;&#xa;&#x27;&#x27; as rating_user_agent&#xd;&#xa;from rdl_vertical_services.fixpl_feedback&#xd;&#xa;group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16&#xd;&#xa;order by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from aux_vert_services_fixly_odl_feedback&#x3b;&#xd;&#xa;-- select &#x2a; from odl_global_verticals.vert_services_fixly_odl_feedback&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_novos_feedback&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_feedback as m&#xd;&#xa;  FULL OUTER JOIN  aux_vert_services_fixly_odl_feedback as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where&#xd;&#xa;      m.id is null order by a.created_at asc&#x3b;&#xd;&#xa;-- select &#x2a; from tmp_novos&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_novos&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_feedback&#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;CREATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  value,&#xd;&#xa;  comment,&#xd;&#xa;  service_request_id,&#xd;&#xa;  service_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  title,&#xd;&#xa;  active,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  rating_user_agent&#xd;&#xa;from tmp_novos_feedback&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_feedback&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_feedback as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_feedback as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_feedback&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_feedback &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;UPDATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  value,&#xd;&#xa;  comment,&#xd;&#xa;  service_request_id,&#xd;&#xa;  service_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  title,&#xd;&#xa;  active,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  rating_user_agent&#xd;&#xa;from tmp_updated_feedback&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_feedback&#xd;&#xa;from aux_vert_services_fixly_odl_feedback as a&#xd;&#xa;  left join odl_global_verticals.vert_services_fixly_odl_feedback as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_feedback &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;DELETED&#x27; as status,&#xd;&#xa;    db_name,&#xd;&#xa;  id,&#xd;&#xa;  value,&#xd;&#xa;  comment,&#xd;&#xa;  service_request_id,&#xd;&#xa;  service_id,&#xd;&#xa;  from_id,&#xd;&#xa;  to_id,&#xd;&#xa;  title,&#xd;&#xa;  active,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  rating_user_agent&#xd;&#xa;from tmp_deleted_feedback&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>576</xloc>
      <yloc>304</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_users</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;--------------------------------------------------------&#xd;&#xa;-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- users&#xd;&#xa;-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- users&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_users&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_users&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_users&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_users &#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;create table aux_vert_services_fixly_odl_users &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id  integer,&#xd;&#xa;email VARCHAR&#x28;256&#x29;,&#xd;&#xa;password VARCHAR&#x28;256&#x29;,&#xd;&#xa;&#xb4;permissions&#xb4; VARCHAR&#x28;256&#x29;,&#xd;&#xa;last_login timestamp,&#xd;&#xa;first_name VARCHAR&#x28;256&#x29;,&#xd;&#xa;last_name VARCHAR&#x28;256&#x29;,&#xd;&#xa;email_verified bool,&#xd;&#xa;created_at timestamp,&#xd;&#xa;updated_at timestamp,&#xd;&#xa;deleted_at timestamp,&#xd;&#xa;userable_id INTEGER,&#xd;&#xa;userable_type VARCHAR&#x28;256&#x29;,&#xd;&#xa;phone VARCHAR&#x28;256&#x29;,&#xd;&#xa;address VARCHAR&#x28;256&#x29;,&#xd;&#xa;city_id INTEGER,&#xd;&#xa;zip_code INTEGER,&#xd;&#xa;region_id INTEGER,&#xd;&#xa;district_id INTEGER,&#xd;&#xa;country_id INTEGER,&#xd;&#xa;guest bool,&#xd;&#xa;profile_completed bool,&#xd;&#xa;linked_accounts VARCHAR&#x28;256&#x29;,&#xd;&#xa;verifications VARCHAR&#x28;256&#x29;,&#xd;&#xa;avatar_url VARCHAR&#x28;256&#x29;,&#xd;&#xa;slug VARCHAR&#x28;256&#x29;,&#xd;&#xa;cover_url VARCHAR&#x28;256&#x29;,&#xd;&#xa;settings VARCHAR&#x28;256&#x29;,&#xd;&#xa;last_activity timestamp,&#xd;&#xa;privacy integer,&#xd;&#xa;facebook_id VARCHAR&#x28;256&#x29;,&#xd;&#xa;radius integer,&#xd;&#xa;profile_completion VARCHAR&#x28;5000&#x29;,&#xd;&#xa;user_agent VARCHAR&#x28;500&#x29;,&#xd;&#xa;consents_tos_checked_at timestamp,&#xd;&#xa;consents_subscribe_checked_at timestamp,&#xd;&#xa;rol_name  VARCHAR&#x28;300&#x29;,&#xd;&#xa;is_provider VARCHAR&#x28;30&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;insert into aux_vert_services_fixly_odl_users&#xd;&#xa;select&#xd;&#xa;    current_date   AS inserted_date,&#xd;&#xa;    &#x27;&#x27;             AS status,&#xd;&#xa;    &#x27;fixly-poland&#x27; AS db_name,&#xd;&#xa;  usr.id,&#xd;&#xa;  email,&#xd;&#xa;  password,&#xd;&#xa;  NULL as  per,&#xd;&#xa;  last_login,&#xd;&#xa;  first_name,&#xd;&#xa;  last_name,&#xd;&#xa;  email_verified,&#xd;&#xa;  usr.created_at,&#xd;&#xa;  usr.updated_at,&#xd;&#xa;  usr.deleted_at,&#xd;&#xa;  userable_id,&#xd;&#xa;  userable_type,&#xd;&#xa;  phone,&#xd;&#xa;  address,&#xd;&#xa;  city_id,&#xd;&#xa;  zip_code,&#xd;&#xa;  region_id,&#xd;&#xa;  district_id,&#xd;&#xa;  country_id,&#xd;&#xa;  guest,&#xd;&#xa;  profile_completed,&#xd;&#xa;  linked_accounts,&#xd;&#xa;  verifications,&#xd;&#xa;  avatar_url,&#xd;&#xa;  usr.slug,&#xd;&#xa;  cover_url,&#xd;&#xa;  settings,&#xd;&#xa;  last_activity,&#xd;&#xa;  privacy,&#xd;&#xa;  facebook_id,&#xd;&#xa;  radius,&#xd;&#xa;  profile_completion,&#xd;&#xa;  user_agent,&#xd;&#xa;  consents_tos_checked_at,&#xd;&#xa;  consents_subscribe_checked_at,&#xd;&#xa;  r3.name as rol,&#xd;&#xa;  case when R3.slug&#x3d;&#x27;individual&#x27; then &#x27;y&#x27;&#xd;&#xa;    else &#x27;n&#x27; end as is_provider&#xd;&#xa;FROM rdl_vertical_services.fixpl_users as usr&#xd;&#xa;LEFT JOIN rdl_vertical_services.fixpl_role_users AS R_U ON R_U.user_id &#x3d; usr.id&#xd;&#xa;LEFT JOIN rdl_vertical_services.fixpl_roles AS R3       ON R_U.role_id &#x3d; R3.id&#xd;&#xa;group by 1,2,3,4,5,6,7,8,9,10&#xd;&#xa;        ,11,12,13,14,15,16,17,18,19,20&#xd;&#xa;        ,21,22,23,24,25,26,27,28,29,30&#xd;&#xa;        ,31,32,33,34,35,36,37,38,39,40,41&#xd;&#xa;order by 1,2,3,4,5,6,7,8,9,10&#xd;&#xa;        ,11,12,13,14,15,16,17,18,19,20&#xd;&#xa;        ,21,22,23,24,25,26,27,28,29,30&#xd;&#xa;        ,31,32,33,34,35,36,37,38,39,40,41&#xd;&#xa;        &#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from aux_vert_services_fixly_odl_users&#x3b;&#xd;&#xa;-- select &#x2a; from odl_global_verticals.vert_services_fixly_odl_users&#x3b;&#xd;&#xa;-- delete from odl_global_verticals.vert_services_fixly_odl_users &#x3b;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_novos_users&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_users as m&#xd;&#xa;  full outer join aux_vert_services_fixly_odl_users as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where m.id is null&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_novos&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_users &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;CREATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  email,&#xd;&#xa;  password,&#xd;&#xa;  &#x22;&#xb4;permissions&#xb4;&#x22;,&#xd;&#xa;  last_login,&#xd;&#xa;  first_name,&#xd;&#xa;  last_name,&#xd;&#xa;  email_verified,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  userable_id,&#xd;&#xa;  userable_type,&#xd;&#xa;  phone,&#xd;&#xa;  address,&#xd;&#xa;  city_id,&#xd;&#xa;  zip_code,&#xd;&#xa;  region_id,&#xd;&#xa;  district_id,&#xd;&#xa;  country_id,&#xd;&#xa;  guest,&#xd;&#xa;  profile_completed,&#xd;&#xa;  linked_accounts,&#xd;&#xa;  verifications,&#xd;&#xa;  avatar_url,&#xd;&#xa;  slug,&#xd;&#xa;  cover_url,&#xd;&#xa;  settings,&#xd;&#xa;  last_activity,&#xd;&#xa;  privacy,&#xd;&#xa;  facebook_id,&#xd;&#xa;  radius,&#xd;&#xa;  profile_completion,&#xd;&#xa;  user_agent,&#xd;&#xa;  consents_tos_checked_at,&#xd;&#xa;  consents_subscribe_checked_at,&#xd;&#xa;  rol_name,&#xd;&#xa;  is_provider&#xd;&#xa;from tmp_novos_users&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_users&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_users as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_users as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_users&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_users&#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;UPDATED&#x27; as status,&#xd;&#xa;  db_name,&#xd;&#xa;  id,&#xd;&#xa;  email,&#xd;&#xa;  password,&#xd;&#xa;  &#x22;&#xb4;permissions&#xb4;&#x22;,&#xd;&#xa;  last_login,&#xd;&#xa;  first_name,&#xd;&#xa;  last_name,&#xd;&#xa;  email_verified,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  userable_id,&#xd;&#xa;  userable_type,&#xd;&#xa;  phone,&#xd;&#xa;  address,&#xd;&#xa;  city_id,&#xd;&#xa;  zip_code,&#xd;&#xa;  region_id,&#xd;&#xa;  district_id,&#xd;&#xa;  country_id,&#xd;&#xa;  guest,&#xd;&#xa;  profile_completed,&#xd;&#xa;  linked_accounts,&#xd;&#xa;  verifications,&#xd;&#xa;  avatar_url,&#xd;&#xa;  slug,&#xd;&#xa;  cover_url,&#xd;&#xa;  settings,&#xd;&#xa;  last_activity,&#xd;&#xa;  privacy,&#xd;&#xa;  facebook_id,&#xd;&#xa;  radius,&#xd;&#xa;  profile_completion,&#xd;&#xa;  user_agent,&#xd;&#xa;  consents_tos_checked_at,&#xd;&#xa;  consents_subscribe_checked_at,&#xd;&#xa;  rol_name,&#xd;&#xa;  is_provider&#xd;&#xa;from tmp_updated_users&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_users&#xd;&#xa;from aux_vert_services_fixly_odl_users as a&#xd;&#xa;  left join odl_global_verticals.vert_services_fixly_odl_users as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_users &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  inserted_date,&#xd;&#xa;  &#x27;DELETED&#x27; as status,&#xd;&#xa;db_name,&#xd;&#xa;  id,&#xd;&#xa;  email,&#xd;&#xa;  password,&#xd;&#xa;  &#x22;&#xb4;permissions&#xb4;&#x22;,&#xd;&#xa;  last_login,&#xd;&#xa;  first_name,&#xd;&#xa;  last_name,&#xd;&#xa;  email_verified,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  userable_id,&#xd;&#xa;  userable_type,&#xd;&#xa;  phone,&#xd;&#xa;  address,&#xd;&#xa;  city_id,&#xd;&#xa;  zip_code,&#xd;&#xa;  region_id,&#xd;&#xa;  district_id,&#xd;&#xa;  country_id,&#xd;&#xa;  guest,&#xd;&#xa;  profile_completed,&#xd;&#xa;  linked_accounts,&#xd;&#xa;  verifications,&#xd;&#xa;  avatar_url,&#xd;&#xa;  slug,&#xd;&#xa;  cover_url,&#xd;&#xa;  settings,&#xd;&#xa;  last_activity,&#xd;&#xa;  privacy,&#xd;&#xa;  facebook_id,&#xd;&#xa;  radius,&#xd;&#xa;  profile_completion,&#xd;&#xa;  user_agent,&#xd;&#xa;  consents_tos_checked_at,&#xd;&#xa;  consents_subscribe_checked_at,&#xd;&#xa;  rol_name,&#xd;&#xa;  is_provider&#xd;&#xa;from tmp_deleted_users&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>688</xloc>
      <yloc>384</yloc>
    </entry>
    <entry>
      <name>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_requests</name>
      <description/>
      <type>SQL</type>
      <sql>-- ------------------------------------------------------------------------&#xd;&#xa;-- ODL FIXLY&#xd;&#xa;-- -----------------------------------------------------------------------&#xd;&#xa;-- SERVICE REQUESTS&#xd;&#xa;drop table if exists  aux_vert_services_fixly_odl_service_requests&#x3b;&#xd;&#xa;drop table if exists  tmp_novos_service_requests&#x3b;&#xd;&#xa;drop table if exists  tmp_updated_service_requests&#x3b;&#xd;&#xa;drop table if exists  tmp_deleted_service_requests&#x3b;&#xd;&#xa;&#xd;&#xa;create temp table aux_vert_services_fixly_odl_service_requests &#x28;&#xd;&#xa;inserted_date      DATE,&#xd;&#xa;status     VARCHAR &#x28;30&#x29;,&#xd;&#xa;db_name    VARCHAR &#x28;30&#x29;,&#xd;&#xa;id  integer,&#xd;&#xa;  user_id integer,&#xd;&#xa;  category_id integer,&#xd;&#xa;  status_sr varchar&#x28;256&#x29;,&#xd;&#xa;  to_user_id integer,&#xd;&#xa;  lat DOUBLE PRECISION,&#xd;&#xa;  lon DOUBLE PRECISION,&#xd;&#xa;  address varchar &#x28;1000&#x29;,&#xd;&#xa;  user_agent varchar&#x28;256&#x29;,&#xd;&#xa;  created_at timestamp,&#xd;&#xa;  updated_at timestamp,&#xd;&#xa;  deleted_at timestamp,&#xd;&#xa;  exacdate timestamp,&#xd;&#xa;  city_id integer,&#xd;&#xa;  user_type VARCHAR&#x28;10&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- insert like this just for the first time&#xd;&#xa;insert into  aux_vert_services_fixly_odl_service_requests &#x28;&#xd;&#xa;select&#xd;&#xa;  current_date as inserted_date,&#xd;&#xa;  &#x27;&#x27; as status,&#xd;&#xa;  &#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;  id,&#xd;&#xa;  user_id,&#xd;&#xa;  category_id,&#xd;&#xa;  status,&#xd;&#xa;  to_user_id,&#xd;&#xa;  lat,&#xd;&#xa;  lon,&#xd;&#xa;  address,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  exacdate,&#xd;&#xa;  city_id,&#xd;&#xa; &#x27;&#x27; as  user_type&#xd;&#xa;from       rdl_vertical_services.fixpl_service_requests&#xd;&#xa;group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18&#xd;&#xa;order by 1,2,3,4,5&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- CREATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_novos_service_requests&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_requests as m&#xd;&#xa;  FULL OUTER JOIN  aux_vert_services_fixly_odl_service_requests as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where&#xd;&#xa;      m.id is null order by a.created_at asc&#x3b;&#xd;&#xa;-- select &#x2a; from tmp_novos_service_request_messages&#x3b;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_service_requests&#x28;&#xd;&#xa;SELECT&#xd;&#xa;  current_date as inserted_date,&#xd;&#xa;&#x27;CREATED&#x27; as status,&#xd;&#xa;&#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;  id,&#xd;&#xa;  user_id,&#xd;&#xa;  category_id,&#xd;&#xa;  status,&#xd;&#xa;  to_user_id,&#xd;&#xa;  lat,&#xd;&#xa;  lon,&#xd;&#xa;  address,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  exacdate,&#xd;&#xa;  city_id,&#xd;&#xa;  user_type&#xd;&#xa;from tmp_novos_service_requests&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- UPDATED&#xd;&#xa;select a.&#x2a;&#xd;&#xa;into temp tmp_updated_service_requests&#xd;&#xa;from odl_global_verticals.vert_services_fixly_odl_service_requests as m&#xd;&#xa;  INNER JOIN aux_vert_services_fixly_odl_service_requests as a&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where a.updated_at&#x3e; &#x28;select max&#x28;updated_at&#x29;&#xd;&#xa;                     from&#xd;&#xa;                     odl_global_verticals.vert_services_fixly_odl_service_requests&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;insert into odl_global_verticals.vert_services_fixly_odl_service_requests  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  current_date as inserted_date,&#xd;&#xa;&#x27;UPDATED&#x27; as status,&#xd;&#xa;&#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;  id,&#xd;&#xa;  user_id,&#xd;&#xa;  category_id,&#xd;&#xa;  status,&#xd;&#xa;  to_user_id,&#xd;&#xa;  lat,&#xd;&#xa;  lon,&#xd;&#xa;  address,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  exacdate,&#xd;&#xa;  city_id,&#xd;&#xa;  user_type&#xd;&#xa;from tmp_updated_service_requests&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- DELETED&#xd;&#xa;select m.&#x2a;&#xd;&#xa;into temp tmp_deleted_service_requests&#xd;&#xa;from aux_vert_services_fixly_odl_service_requests as a&#xd;&#xa;  left join odl_global_verticals.vert_services_fixly_odl_service_requests as m&#xd;&#xa;    on &#x28;m.id&#x3d;a.id and m.db_name&#x3d;a.db_name&#x29;&#xd;&#xa;where  m.id is not null&#xd;&#xa;       and&#xd;&#xa;      a.id is null&#xd;&#xa;and   m.status&#x3c;&#x3e;&#x27;DELETED&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;-- select &#x2a; from tmp_deleted&#x3b;&#xd;&#xa;insert into  odl_global_verticals.vert_services_fixly_odl_service_requests &#x28;&#xd;&#xa;SELECT&#xd;&#xa;  current_date as inserted_date,&#xd;&#xa;&#x27;DELETED&#x27; as status,&#xd;&#xa;&#x27;fixly-poland&#x27; as db_name,&#xd;&#xa;  id,&#xd;&#xa;  user_id,&#xd;&#xa;  category_id,&#xd;&#xa;  status,&#xd;&#xa;  to_user_id,&#xd;&#xa;  lat,&#xd;&#xa;  lon,&#xd;&#xa;  address,&#xd;&#xa;  user_agent,&#xd;&#xa;  created_at,&#xd;&#xa;  updated_at,&#xd;&#xa;  deleted_at,&#xd;&#xa;  exacdate,&#xd;&#xa;  city_id,&#xd;&#xa;  user_type&#xd;&#xa;from tmp_deleted_service_requests&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>Chandra Redshift</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>784</xloc>
      <yloc>464</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>START</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_messages</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_messages</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_conversations</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_request_conversations</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_offers</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_offers</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_feedback</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_feedback</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_users</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_users</from>
      <to>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_requests</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>ODL - Model - odl_global_verticals.vert_services_fixly_odl_service_requests</from>
      <to>&#xc9;xito</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
